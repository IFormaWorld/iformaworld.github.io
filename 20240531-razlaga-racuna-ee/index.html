<html lang="en">
<head>
  <title>AR za razlago računov električne energije - MindAR with Three.js - Multiple Image Targets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
  <!-- Load Three.js as a module -->
  <script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.137.5/build/three.module.js';
    import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.137.5/examples/jsm/loaders/GLTFLoader.js';
    import { MindARThree } from 'https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js';

    document.addEventListener('DOMContentLoaded', () => {
      const start = async () => {
        const mindarThree = new MindARThree({
          container: document.body,
          imageTargetSrc: 'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/targets/razlaga-racuna.mind',
        });
        const { renderer, scene, camera } = mindarThree;

        // Add light to the scene
        const light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1);
        scene.add(light);

        const gltfLoader = new GLTFLoader();

        // Load models
        const modelUrls = [
          'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/models/dobavitelj/scene.gltf',
          'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/models/smm/scene.gltf',
          'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/models/znesek/scene.gltf',
          'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/models/poraba/scene.gltf',
          'https://cdn.jsdelivr.net/gh/IFormaWorld/iformaworld.github.io/20240531-razlaga-racuna-ee/assets/models/reklamacija/scene.gltf'
        ];

        // Function to load model
        const loadModel = (url, loader) => {
          return new Promise((resolve, reject) => {
            loader.load(url, (gltf) => {
              gltf.scene.scale.set(0.1, 0.1, 0.1);
              gltf.scene.position.set(0, -0.4, 0);
              resolve(gltf);
            }, undefined, reject);
          });
        };

        try {
          const models = await Promise.all(modelUrls.map(url => loadModel(url, gltfLoader)));

          // Create anchors
          models.forEach((model, index) => {
            const anchor = mindarThree.addAnchor(index);
            anchor.group.add(model.scene);
          });

          await mindarThree.start();

          renderer.setAnimationLoop(() => {
            renderer.render(scene, camera);
          });
        } catch (error) {
          console.error('Error loading models:', error);
        }
      };

      start();
    });
  </script>
</body>
</html>
